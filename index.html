<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>醫師勾選單 - 購物車範例</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { text-align: center; }
    .products, .cart { margin: 20px 0; }
    .item { border: 1px solid #ccc; padding: 10px; margin: 5px; display: inline-block; width: 180px; text-align: center; }
    button { margin-top: 5px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  </style>
</head>
<body>

<h1>醫師勾選單</h1>

<!-- 單品區 -->
<div class="products">
  <h2>單品</h2>
  <div id="product-list"></div>
</div>

<!-- 套組區 -->
<div class="products">
  <h2>套組</h2>
  <div id="bundle-list"></div>
</div>

<!-- 購物車 -->
<div class="cart">
  <h2>購物車</h2>
  <table>
    <thead>
      <tr><th>品項</th><th>數量</th><th>小計</th><th>操作</th></tr>
    </thead>
    <tbody id="cart-body"></tbody>
  </table>
  <h3 id="total">總計：$0</h3>
</div>

<script>
// 單品資料
const products = [
  { id: "mnt_protein", name: "MNT 蛋白粉", price: 1880 },
  { id: "light_digest", name: "暢便輕", price: 1200 },
  { id: "wei_shijia", name: "衛適佳", price: 1200 },
  { id: "jiao_yuan_c", name: "嬌圓C", price: 1200 },
  { id: "morning_capsule", name: "早安膠囊", price: 900 },
  { id: "night_chew", name: "晚安咀嚼錠", price: 900 },
  { id: "oil_cut", name: "油澱雙切", price: 600 },
  { id: "elite", name: "優先盈", price: 1500 },
  { id: "clean_mouth", name: "清口樂", price: 600 },
  { id: "double_l", name: "雙L益菌糖", price: 1200 },
  { id: "fish_oil", name: "黃晶魚油", price: 1300 },
  { id: "night_relax", name: "夜允眠", price: 1300 },
  { id: "sensitive", name: "允敏通", price: 1300 },
  { id: "berry", name: "允媄莓", price: 1300 }
];

// 套組資料
const bundles = [
  {
    id: "classic",
    name: "經典套組",
    items: [
      { productId: "mnt_protein", qty: 3 },
      { productId: "light_digest", qty: 2 },
      { productId: "wei_shijia", qty: 1 },
      { productId: "jiao_yuan_c", qty: 2 },
      { productId: "morning_capsule", qty: 1 },
      { productId: "night_chew", qty: 1 },
      { productId: "oil_cut", qty: 1 },
      { productId: "elite", qty: 1 },
      { productId: "clean_mouth", qty: 1 }
    ],
    displayPrice: 15000,
    basePrice: 16140
  },
  {
    id: "upgrade",
    name: "超值升級套組",
    displayPrice: 30000,
    basePrice: 33340
  },
  {
    id: "slim",
    name: "輕盈套組",
    displayPrice: 9800,
    basePrice: 9840
  }
];

// 購物車
let cart = [];

// 加入購物車
function addToCart(itemId, type, price, name) {
  const existing = cart.find(i => i.id === itemId && i.type === type);
  if (existing) {
    existing.qty += 1;
  } else {
    cart.push({ id: itemId, type, qty: 1, price, name });
  }
  renderCart();
}

// 渲染購物車
function renderCart() {
  const tbody = document.getElementById("cart-body");
  tbody.innerHTML = "";
  let total = 0;
  cart.forEach((item, idx) => {
    const subtotal = item.price * item.qty;
    total += subtotal;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${item.name}</td>
      <td>${item.qty}</td>
      <td>$${subtotal}</td>
      <td>
        <button onclick="changeQty(${idx}, 1)">+</button>
        <button onclick="changeQty(${idx}, -1)">-</button>
        <button onclick="removeItem(${idx})">刪除</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
  document.getElementById("total").innerText = "總計：$" + total;
}

// 改變數量
function changeQty(index, delta) {
  cart[index].qty += delta;
  if (cart[index].qty <= 0) cart.splice(index, 1);
  renderCart();
}

// 移除項目
function removeItem(index) {
  cart.splice(index, 1);
  renderCart();
}

// 初始化商品
function renderProducts() {
  const productDiv = document.getElementById("product-list");
  products.forEach(p => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <h4>${p.name}</h4>
      <p>$${p.price}</p>
      <button onclick="addToCart('${p.id}','single',${p.price},'${p.name}')">加入購物車</button>
    `;
    productDiv.appendChild(div);
  });

  const bundleDiv = document.getElementById("bundle-list");
  bundles.forEach(b => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <h4>${b.name}</h4>
      <p>優惠價 $${b.displayPrice}</p>
      <button onclick="addToCart('${b.id}','bundle',${b.displayPrice},'${b.name}')">加入購物車</button>
    `;
    bundleDiv.appendChild(div);
  });
}

// 啟動
renderProducts();
renderCart();
</script>
</body>
</html>
